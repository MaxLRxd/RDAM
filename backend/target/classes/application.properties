spring.application.name=backend
# ============================================================
# SISTEMA RDAM — application.properties
# ============================================================


# ------------------------------------------------------------
# SERVIDOR
# ------------------------------------------------------------
server.port=8080
server.servlet.context-path=/api/v1

# URL base usada para construir links de descarga en emails.
# En producción: https://rdam.santafe.gob.ar
server.base-url=${SERVER_BASE_URL:http://localhost:8080}


# ------------------------------------------------------------
# BASE DE DATOS
# ------------------------------------------------------------
spring.datasource.url=${DB_URL}
spring.datasource.username=${DB_USERNAME}
spring.datasource.password=${DB_PASSWORD}
spring.datasource.driver-class-name=com.mysql.cj.jdbc.Driver

# Pool de conexiones HikariCP (viene con Spring Boot)
spring.datasource.hikari.maximum-pool-size=10
spring.datasource.hikari.minimum-idle=2
spring.datasource.hikari.connection-timeout=30000


# ------------------------------------------------------------
# JPA / HIBERNATE
# ------------------------------------------------------------
# validate: Hibernate verifica que el modelo Java coincide
# con las tablas creadas por Flyway. No modifica nada.
spring.jpa.hibernate.ddl-auto=validate
spring.jpa.database-platform=org.hibernate.dialect.MySQL8Dialect

# true en desarrollo para ver las queries generadas.
# Cambiar a false en producción.
spring.jpa.show-sql=true
spring.jpa.properties.hibernate.format_sql=true


# ------------------------------------------------------------
# FLYWAY
# ------------------------------------------------------------
spring.flyway.enabled=true
spring.flyway.locations=classpath:db/migration
spring.flyway.baseline-on-migrate=true


# ------------------------------------------------------------
# REDIS
# ------------------------------------------------------------
spring.data.redis.host=${REDIS_HOST:localhost}
spring.data.redis.port=${REDIS_PORT:6379}
spring.data.redis.password=${REDIS_PASSWORD:}
spring.data.redis.timeout=2000ms


# ------------------------------------------------------------
# MINIO
# ------------------------------------------------------------
minio.endpoint=${MINIO_ENDPOINT}
minio.access-key=${MINIO_ACCESS_KEY}
minio.secret-key=${MINIO_SECRET_KEY}
minio.bucket-name=${MINIO_BUCKET_NAME:rdam-certificados}


# ------------------------------------------------------------
# MAIL
# ------------------------------------------------------------
spring.mail.host=${SMTP_HOST:localhost}
spring.mail.port=${SMTP_PORT:1025}
spring.mail.username=${SMTP_USERNAME:}
spring.mail.password=${SMTP_PASSWORD:}
spring.mail.properties.mail.smtp.auth=${SMTP_AUTH:false}
spring.mail.properties.mail.smtp.starttls.enable=${SMTP_STARTTLS:false}

rdam.mail.from=${MAIL_FROM:noreply@rdam.santafe.gob.ar}


# ------------------------------------------------------------
# JWT
# ------------------------------------------------------------
rdam.jwt.secret=${JWT_SECRET}
rdam.jwt.expiration-ms=28800000


# ------------------------------------------------------------
# PAGOS
# ------------------------------------------------------------
rdam.payment.mode=${PAYMENT_MODE:sim}
rdam.payment.hmac-secret=${PLUSPAGOS_HMAC_SECRET:dev-secret}
rdam.payment.merchant-guid=${PLUSPAGOS_MERCHANT_GUID:test-merchant-001}
rdam.payment.secret-key=${PLUSPAGOS_SECRET_KEY:clave-secreta-campus-2026}
rdam.payment.api-url=${PLUSPAGOS_API_URL:http://localhost:3000}
rdam.payment.sim-auto-approve=${SIM_AUTO_APPROVE:false}


# ------------------------------------------------------------
# REGLAS DE NEGOCIO
# ------------------------------------------------------------
rdam.negocio.vencimiento-pendiente-dias=${VENCIMIENTO_PENDIENTE_DIAS:60}
rdam.negocio.validez-certificado-dias=${VALIDEZ_CERTIFICADO_DIAS:65}
rdam.negocio.max-upload-size-bytes=10485760
rdam.negocio.monto-arancel=${MONTO_ARANCEL:1500.00}


# ------------------------------------------------------------
# UPLOAD — Tamaño máximo de archivos (para multipart/form-data)
# Debe coincidir con rdam.negocio.max-upload-size-bytes (10 MB)
# ------------------------------------------------------------
spring.servlet.multipart.max-file-size=10MB
spring.servlet.multipart.max-request-size=10MB


# ------------------------------------------------------------
# RATE LIMITING
# ------------------------------------------------------------
rdam.security.rate-limit-por-minuto=10


# ------------------------------------------------------------
# SCHEDULER
# ------------------------------------------------------------
rdam.scheduler.vencimiento-cron=0 0 2 * * *


# ------------------------------------------------------------
# LOGGING
# ------------------------------------------------------------
logging.level.root=INFO

# Muestra logs DEBUG de todo el código propio del proyecto
logging.level.com.rdam.backend=DEBUG

# Útil para ver qué decisiones toma Spring Security en cada request
logging.level.org.springframework.security=DEBUG

# Muestra qué scripts Flyway ejecuta al arrancar
logging.level.org.flywaydb=INFO

# Formato: hora [nivel] clase - mensaje
logging.pattern.console=%d{HH:mm:ss} [%-5level] %logger{30} - %msg%n